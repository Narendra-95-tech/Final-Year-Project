<% var successList=(typeof success !='undefined' && success) ? success : []; if (!Array.isArray(successList)) {
    successList=[successList]; } var errorList=(typeof error !='undefined' && error) ? error : []; if
    (!Array.isArray(errorList)) { errorList=[errorList]; } var cleanSuccess=successList.filter(function(msg) { return
    typeof msg==='string' && msg.trim().length> 0; });
    var cleanError = errorList.filter(function(msg) { return typeof msg === 'string' && msg.trim().length > 0; });

    var successHtml = cleanSuccess.join('<br>');
    var errorHtml = cleanError.join('<br>');
    %>

    <% if (cleanSuccess.length> 0) { %>
        <div class="flash-toast-container">
            <div class="flash-toast success" role="alert">
                <div class="toast-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="toast-content">
                    <div class="toast-message"><%- successHtml %></div>
                </div>
                <button type="button" class="toast-close" onclick="this.parentElement.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <% } %>

            <% if (cleanError.length> 0) { %>
                <div class="flash-toast-container">
                    <div class="flash-toast error" role="alert">
                        <div class="toast-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="toast-content">
                            <div class="toast-message"><%- errorHtml %></div>
                        </div>
                        <button type="button" class="toast-close" onclick="this.parentElement.parentElement.remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <% } %>

                    <% if (cleanSuccess.length> 0 || cleanError.length > 0) { %>
                        <style>
                            .flash-toast-container {
                                position: fixed;
                                top: 20px;
                                left: 50%;
                                transform: translateX(-50%);
                                z-index: 99999;
                                pointer-events: none;
                                max-width: calc(100vw - 40px);
                                width: 100%;
                                max-width: 500px;
                            }

                            .flash-toast {
                                pointer-events: auto;
                                width: 100%;
                                border-radius: 12px;
                                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
                                display: flex;
                                align-items: center;
                                padding: 16px 20px;
                                animation: slideInDown 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                                transition: all 0.3s ease;
                            }

                            .flash-toast:hover {
                                transform: translateY(-2px);
                                box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
                            }

                            .flash-toast.success {
                                background: linear-gradient(135deg, #10b981 0%, #059669 100%);
                                color: white;
                            }

                            .flash-toast.error {
                                background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
                                color: white;
                            }

                            .toast-icon {
                                font-size: 24px;
                                margin-right: 14px;
                                flex-shrink: 0;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                width: 32px;
                                height: 32px;
                                color: white;
                            }

                            .success .toast-icon {
                                animation: successPulse 0.6s ease-out;
                            }

                            .error .toast-icon {
                                animation: errorShake 0.5s ease-out;
                            }

                            @keyframes successPulse {
                                0% {
                                    transform: scale(0.8);
                                    opacity: 0;
                                }

                                50% {
                                    transform: scale(1.2);
                                }

                                100% {
                                    transform: scale(1);
                                    opacity: 1;
                                }
                            }

                            @keyframes errorShake {

                                0%,
                                100% {
                                    transform: translateX(0);
                                }

                                25% {
                                    transform: translateX(-4px);
                                }

                                75% {
                                    transform: translateX(4px);
                                }
                            }

                            .toast-content {
                                flex: 1;
                                margin-right: 12px;
                            }

                            .toast-message {
                                font-size: 15px;
                                color: white;
                                line-height: 1.5;
                                font-weight: 500;
                            }

                            .toast-close {
                                background: rgba(255, 255, 255, 0.2);
                                border: none;
                                color: white;
                                cursor: pointer;
                                padding: 6px;
                                font-size: 16px;
                                border-radius: 6px;
                                transition: all 0.2s ease;
                                flex-shrink: 0;
                                width: 32px;
                                height: 32px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                            }

                            .toast-close:hover {
                                background: rgba(255, 255, 255, 0.3);
                                transform: rotate(90deg);
                            }

                            @keyframes slideInDown {
                                from {
                                    transform: translateY(-100%);
                                    opacity: 0;
                                }

                                to {
                                    transform: translateY(0);
                                    opacity: 1;
                                }
                            }

                            @keyframes slideOutUp {
                                to {
                                    transform: translateY(-100%);
                                    opacity: 0;
                                }
                            }

                            @media (max-width: 767px) {
                                .flash-toast-container {
                                    top: 15px;
                                    max-width: calc(100vw - 30px);
                                }

                                .flash-toast {
                                    padding: 14px 16px;
                                }

                                .toast-icon {
                                    font-size: 22px;
                                    width: 28px;
                                    height: 28px;
                                }

                                .toast-message {
                                    font-size: 14px;
                                }
                            }

                            @media (max-width: 575px) {
                                .flash-toast-container {
                                    top: 10px;
                                    max-width: calc(100vw - 20px);
                                }

                                .flash-toast {
                                    padding: 12px 14px;
                                }

                                .toast-icon {
                                    font-size: 20px;
                                    width: 26px;
                                    height: 26px;
                                }

                                .toast-message {
                                    font-size: 13px;
                                }

                                .toast-close {
                                    width: 28px;
                                    height: 28px;
                                }
                            }
                        </style>

                        <script>
                            document.addEventListener('DOMContentLoaded', () => {
                                const container = document.querySelector('.flash-toast-container');
                                if (!container) return;

                                const toast = container.querySelector('.flash-toast');
                                if (!toast) return;

                                let timeoutId;

                                const dismissToast = () => {
                                    toast.style.animation = 'slideOutUp 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards';
                                    setTimeout(() => container.remove(), 400);
                                };

                                timeoutId = setTimeout(dismissToast, 4000);

                                toast.addEventListener('mouseenter', () => clearTimeout(timeoutId));
                                toast.addEventListener('mouseleave', () => timeoutId = setTimeout(dismissToast, 2000));

                                const closeBtn = toast.querySelector('.toast-close');
                                if (closeBtn) {
                                    closeBtn.addEventListener('click', (e) => {
                                        e.stopPropagation();
                                        clearTimeout(timeoutId);
                                        dismissToast();
                                    });
                                }
                            });
                        </script>
                        <% } %>