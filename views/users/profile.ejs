<% layout("layouts/boilerplate") %>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet">

    <style>
        * {
            font-family: 'Inter', sans-serif !important;
        }

        .profile-page {
            background: #f0f2f8;
            min-height: 100vh;
            padding-bottom: 4rem;
        }

        /* ‚îÄ‚îÄ Cover ‚îÄ‚îÄ */
        .profile-cover {
            height: 280px;
            background: linear-gradient(135deg, #0f1729 0%, #1a1a3e 40%, #0f3460 100%);
            position: relative;
            overflow: hidden;
        }

        .profile-cover::before {
            content: '';
            position: absolute;
            inset: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        .cover-orb-1 {
            position: absolute;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(99, 102, 241, 0.25) 0%, transparent 70%);
            top: -150px;
            right: -100px;
        }

        .cover-orb-2 {
            position: absolute;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(16, 185, 129, 0.15) 0%, transparent 70%);
            bottom: -100px;
            left: 100px;
        }

        .btn-edit-cover {
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(255, 255, 255, 0.12);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            border-radius: 10px;
            padding: 8px 16px;
            font-size: 0.8rem;
            font-weight: 600;
            text-decoration: none;
            backdrop-filter: blur(10px);
            transition: all 0.2s;
        }

        .btn-edit-cover:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        /* ‚îÄ‚îÄ Avatar Zone ‚îÄ‚îÄ */
        .avatar-zone {
            position: relative;
            margin-top: -70px;
            padding: 0 2rem 0;
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 16px;
        }

        .avatar-wrap {
            position: relative;
            width: 140px;
            height: 140px;
            flex-shrink: 0;
        }

        .avatar-img {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            border: 5px solid white;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
            object-fit: cover;
            background: white;
        }

        .avatar-initial {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            border: 5px solid white;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3.5rem;
            font-weight: 900;
            color: white;
        }

        .verified-dot {
            position: absolute;
            bottom: 6px;
            right: 6px;
            width: 28px;
            height: 28px;
            background: #22c55e;
            border: 3px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            color: white;
        }

        .profile-actions {
            display: flex;
            gap: 10px;
            padding-bottom: 12px;
        }

        /* ‚îÄ‚îÄ White card ‚îÄ‚îÄ */
        .white-card {
            background: white;
            border-radius: 20px;
            padding: 1.8rem;
            box-shadow: 0 2px 16px rgba(0, 0, 0, 0.05);
            margin-bottom: 1.5rem;
        }

        .card-title {
            font-size: 1rem;
            font-weight: 800;
            color: #111827;
            margin-bottom: 1.2rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-title i {
            color: #6366f1;
        }

        /* ‚îÄ‚îÄ Stat Pill ‚îÄ‚îÄ */
        .stat-pills {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .stat-pill {
            flex: 1;
            min-width: 100px;
            text-align: center;
            padding: 1rem;
            border-radius: 16px;
            background: #f8faff;
            border: 1px solid #e8e9ff;
        }

        .stat-pill .val {
            font-size: 1.8rem;
            font-weight: 900;
            color: #111827;
            line-height: 1;
        }

        .stat-pill .lbl {
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            color: #9ca3af;
            margin-top: 4px;
        }

        /* ‚îÄ‚îÄ Info Row ‚îÄ‚îÄ */
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #f3f4f6;
            font-size: 0.9rem;
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-key {
            color: #9ca3af;
            font-weight: 500;
        }

        .info-val {
            color: #111827;
            font-weight: 600;
            text-align: right;
        }

        /* ‚îÄ‚îÄ Quick Links ‚îÄ‚îÄ */
        .quick-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 14px;
            border-radius: 14px;
            text-decoration: none;
            color: #111827;
            font-weight: 600;
            font-size: 0.88rem;
            border: 1px solid #f0f0f0;
            margin-bottom: 8px;
            transition: all 0.2s;
        }

        .quick-link:hover {
            background: #f5f3ff;
            border-color: #c4b5fd;
            color: #6366f1;
            transform: translateX(4px);
        }

        .quick-link .ql-icon {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .quick-link .ql-badge {
            margin-left: auto;
            background: #f3f4f6;
            color: #6b7280;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 99px;
        }

        .quick-link:hover .ql-badge {
            background: #ede9fe;
            color: #6366f1;
        }

        /* ‚îÄ‚îÄ Listing mini card ‚îÄ‚îÄ */
        .mini-items {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .mini-item {
            display: flex;
            gap: 12px;
            align-items: center;
            padding: 10px;
            border: 1px solid #f3f4f6;
            border-radius: 14px;
            text-decoration: none;
            color: #111827;
            transition: all 0.2s;
        }

        .mini-item:hover {
            border-color: #c4b5fd;
            background: #f5f3ff;
        }

        .mini-item img {
            width: 52px;
            height: 52px;
            border-radius: 10px;
            object-fit: cover;
            flex-shrink: 0;
        }

        .mini-item-no-img {
            width: 52px;
            height: 52px;
            border-radius: 10px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .mini-item-title {
            font-weight: 700;
            font-size: 0.88rem;
            line-height: 1.2;
        }

        .mini-item-sub {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-top: 2px;
        }

        /* ‚îÄ‚îÄ Recent Bookings ‚îÄ‚îÄ */
        .booking-row {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid #f9fafb;
        }

        .booking-row:last-child {
            border-bottom: none;
        }

        .booking-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 1rem;
        }

        .booking-status {
            margin-left: auto;
            padding: 3px 10px;
            border-radius: 999px;
            font-size: 0.65rem;
            font-weight: 800;
            text-transform: uppercase;
        }

        /* ‚îÄ‚îÄ Badges ‚îÄ‚îÄ */
        .badge-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .badge-item {
            text-align: center;
        }

        .badge-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            margin: 0 auto 6px;
        }

        .badge-name {
            font-size: 0.7rem;
            font-weight: 700;
            color: #6b7280;
        }

        /* ‚îÄ‚îÄ Social pills ‚îÄ‚îÄ */
        .social-row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .social-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            border-radius: 12px;
            background: #f3f4f6;
            color: #374151;
            font-size: 0.8rem;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.2s;
        }

        .social-btn:hover {
            color: white;
        }

        .social-btn.fb:hover {
            background: #1877f2;
        }

        .social-btn.tw:hover {
            background: #1da1f2;
        }

        .social-btn.ig:hover {
            background: linear-gradient(135deg, #833ab4, #fd1d1d);
        }

        /* ‚îÄ‚îÄ Btn styles ‚îÄ‚îÄ */
        .btn-primary-custom {
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 10px 20px;
            font-weight: 700;
            font-size: 0.88rem;
            text-decoration: none;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary-custom:hover {
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.35);
        }

        .btn-outline-custom {
            background: white;
            color: #374151;
            border: 1.5px solid #e5e7eb;
            border-radius: 12px;
            padding: 9px 18px;
            font-weight: 600;
            font-size: 0.88rem;
            text-decoration: none;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-outline-custom:hover {
            border-color: #6366f1;
            color: #6366f1;
        }

        /* Earnings bar */
        .earnings-highlight {
            background: linear-gradient(135deg, #0f1729, #1e3a5f);
            border-radius: 18px;
            padding: 1.5rem;
            color: white;
        }
    </style>

    <div class="profile-page">

        <!-- ‚îÄ‚îÄ Cover ‚îÄ‚îÄ -->
        <div class="profile-cover">
            <div class="cover-orb-1"></div>
            <div class="cover-orb-2"></div>
            <a href="/profile/edit" class="btn-edit-cover"><i class="fas fa-pen me-2"></i>Edit Profile</a>
        </div>

        <div class="container" style="max-width:1100px; padding: 0 1rem;">

            <!-- ‚îÄ‚îÄ Avatar + Actions ‚îÄ‚îÄ -->
            <div class="avatar-zone mb-4">
                <div class="d-flex align-items-end gap-3 flex-wrap">
                    <div class="avatar-wrap">
                        <% if(user.avatar && user.avatar.url) { %>
                            <img src="<%= user.avatar.url %>" class="avatar-img" alt="<%= user.username %>">
                            <% } else { %>
                                <div class="avatar-initial">
                                    <%= user.username.charAt(0).toUpperCase() %>
                                </div>
                                <% } %>
                                    <% if(user.isVerified) { %>
                                        <div class="verified-dot" title="Verified"><i class="fas fa-check"
                                                style="font-size:0.6rem;"></i></div>
                                        <% } %>
                    </div>
                    <div class="pb-2">
                        <h2 class="fw-900 mb-1" style="font-size:1.8rem; font-weight:900; color:#111827;">
                            <%= user.username %>
                                <% if(user.isVerified) { %><i class="fas fa-check-circle text-primary"
                                        style="font-size:1rem;"></i>
                                    <% } %>
                        </h2>
                        <div class="text-muted" style="font-size:0.9rem;">@<%= user.username.toLowerCase() %>
                                <% if(user.location) { %> ¬∑ <i class="fas fa-map-marker-alt ms-1 me-1"></i>
                                    <%= user.location %>
                                        <% } %>
                        </div>
                        <div class="d-flex gap-2 mt-2 flex-wrap">
                            <span class="badge rounded-pill px-3 py-2"
                                style="background:#f0fdf4; color:#16a34a; border:1px solid #bbf7d0; font-size:0.7rem; font-weight:700;">
                                <i class="fas fa-medal me-1"></i> WanderLust Elite
                            </span>
                            <% if(totalHostedItems> 0) { %>
                                <span class="badge rounded-pill px-3 py-2"
                                    style="background:#ede9fe; color:#7c3aed; border:1px solid #ddd6fe; font-size:0.7rem; font-weight:700;">
                                    <i class="fas fa-home me-1"></i> Host ‚Äî <%= totalHostedItems %> Listings
                                </span>
                                <% } %>
                                    <span class="badge rounded-pill px-3 py-2"
                                        style="background:#fff7ed; color:#c2410c; border:1px solid #fed7aa; font-size:0.7rem; font-weight:700;">
                                        <i class="fas fa-user-check me-1"></i>
                                        <%= user.verificationStatus || 'Not Verified' %>
                                    </span>
                        </div>
                    </div>
                </div>
                <div class="profile-actions">
                    <a href="/profile/edit" class="btn-primary-custom"><i class="fas fa-pen"></i> Edit Profile</a>
                    <a href="/payouts/dashboard" class="btn-outline-custom"><i class="fas fa-chart-line"></i>
                        Earnings</a>
                </div>
            </div>

            <div class="row g-4">

                <!-- ‚ïê‚ïê‚ïê LEFT (Sidebar) ‚ïê‚ïê‚ïê -->
                <div class="col-lg-4">

                    <!-- Stats -->
                    <div class="white-card">
                        <div class="stat-pills">
                            <div class="stat-pill">
                                <div class="val">
                                    <%= bookingCount %>
                                </div>
                                <div class="lbl">Bookings</div>
                            </div>
                            <div class="stat-pill">
                                <div class="val">
                                    <%= reviewCount %>
                                </div>
                                <div class="lbl">Reviews</div>
                            </div>
                            <div class="stat-pill">
                                <div class="val">
                                    <%= favoritesCount %>
                                </div>
                                <div class="lbl">Favorites</div>
                            </div>
                        </div>

                        <% if(totalHostedItems> 0) { %>
                            <div class="earnings-highlight mt-3">
                                <div
                                    style="font-size:0.7rem; text-transform:uppercase; letter-spacing:0.06em; opacity:0.6; margin-bottom:4px;">
                                    Host Net Earnings</div>
                                <div style="font-size:2rem; font-weight:900;">‚Çπ<%= netEarnings.toLocaleString('en-IN')
                                        %>
                                </div>
                                <div style="font-size:0.78rem; opacity:0.6; margin-top:4px;">
                                    <%= totalHostedItems %> active listings ¬∑ 90% cut after platform fee
                                </div>
                            </div>
                            <% } %>
                    </div>

                    <!-- About -->
                    <div class="white-card">
                        <div class="card-title"><i class="fas fa-id-card"></i> About</div>
                        <% if(user.bio) { %>
                            <p
                                style="color:#555; font-size:0.9rem; line-height:1.7; padding:12px; background:#f9f9fb; border-radius:12px; border-left:4px solid #6366f1; margin-bottom:1rem;">
                                <%= user.bio %>
                            </p>
                            <% } else { %>
                                <p class="text-muted small mb-3"><a href="/profile/edit" class="text-primary">Add a
                                        bio</a> to tell guests about yourself.</p>
                                <% } %>

                                    <div class="info-row"><span class="info-key"><i
                                                class="fas fa-envelope me-2"></i>Email</span><span class="info-val">
                                            <%= user.email %>
                                        </span></div>
                                    <div class="info-row"><span class="info-key"><i
                                                class="fas fa-map-marker-alt me-2"></i>Location</span><span
                                            class="info-val">
                                            <%= user.location || '‚Äî' %>
                                        </span></div>
                                    <div class="info-row"><span class="info-key"><i
                                                class="fas fa-calendar me-2"></i>Joined</span><span class="info-val">
                                            <%= new Date(user.createdAt).toLocaleDateString('en-IN',
                                                {year:'numeric',month:'long'}) %>
                                        </span></div>
                                    <div class="info-row"><span class="info-key"><i
                                                class="fas fa-link me-2"></i>Website</span><span class="info-val">
                                            <% if(user.website) { %><a href="<%= user.website %>" target="_blank"
                                                    class="text-primary" style="font-size:0.83rem;">
                                                    <%= user.website.replace(/https?:\/\//, '' ) %>
                                                </a>
                                                <% } else { %>‚Äî<% } %>
                                        </span></div>

                                    <% if(user.social && (user.social.facebook || user.social.twitter ||
                                        user.social.instagram)) { %>
                                        <div class="mt-3">
                                            <div class="info-key mb-2" style="font-size:0.75rem;">SOCIAL LINKS</div>
                                            <div class="social-row">
                                                <% if(user.social.facebook) { %><a href="<%= user.social.facebook %>"
                                                        target="_blank" class="social-btn fb"><i
                                                            class="fab fa-facebook-f"></i> Facebook</a>
                                                    <% } %>
                                                        <% if(user.social.twitter) { %><a
                                                                href="<%= user.social.twitter %>" target="_blank"
                                                                class="social-btn tw"><i class="fab fa-twitter"></i>
                                                                Twitter</a>
                                                            <% } %>
                                                                <% if(user.social.instagram) { %><a
                                                                        href="<%= user.social.instagram %>"
                                                                        target="_blank" class="social-btn ig"><i
                                                                            class="fab fa-instagram"></i> Instagram</a>
                                                                    <% } %>
                                            </div>
                                        </div>
                                        <% } %>
                    </div>

                    <!-- Badges -->
                    <div class="white-card">
                        <div class="card-title"><i class="fas fa-star"></i> Badges</div>
                        <div class="badge-grid">
                            <div class="badge-item">
                                <div class="badge-circle" style="background:#fff7ed; border:2px solid #fed7aa;"><span
                                        style="font-size:1.5rem;">üå±</span></div>
                                <div class="badge-name">Level 1</div>
                            </div>
                            <div class="badge-item">
                                <div class="badge-circle" style="background:#eff6ff; border:2px solid #bfdbfe;"><span
                                        style="font-size:1.5rem;">‚úàÔ∏è</span></div>
                                <div class="badge-name">Traveller</div>
                            </div>
                            <% if(totalHostedItems> 0) { %>
                                <div class="badge-item">
                                    <div class="badge-circle" style="background:#f0fdf4; border:2px solid #bbf7d0;">
                                        <span style="font-size:1.5rem;">üè†</span></div>
                                    <div class="badge-name">Host</div>
                                </div>
                                <% } %>
                                    <% if(reviewCount>= 3) { %>
                                        <div class="badge-item">
                                            <div class="badge-circle"
                                                style="background:#fefce8; border:2px solid #fde68a;"><span
                                                    style="font-size:1.5rem;">‚≠ê</span></div>
                                            <div class="badge-name">Reviewer</div>
                                        </div>
                                        <% } %>
                        </div>
                    </div>

                </div>

                <!-- ‚ïê‚ïê‚ïê RIGHT (Main) ‚ïê‚ïê‚ïê -->
                <div class="col-lg-8">

                    <!-- Quick Links -->
                    <div class="white-card">
                        <div class="card-title"><i class="fas fa-bolt"></i> Quick Actions</div>
                        <div class="row g-2">
                            <div class="col-md-6">
                                <a href="/bookings" class="quick-link">
                                    <div class="ql-icon" style="background:#eff6ff;"><i
                                            class="fas fa-calendar-check text-primary"></i></div>
                                    My Bookings
                                    <span class="ql-badge">
                                        <%= bookingCount %>
                                    </span>
                                </a>
                            </div>
                            <div class="col-md-6">
                                <a href="/wishlist" class="quick-link">
                                    <div class="ql-icon" style="background:#fef2f2;"><i
                                            class="fas fa-heart text-danger"></i></div>
                                    Wishlist
                                    <span class="ql-badge">
                                        <%= favoritesCount %>
                                    </span>
                                </a>
                            </div>
                            <div class="col-md-6">
                                <a href="/payouts/dashboard" class="quick-link">
                                    <div class="ql-icon" style="background:#f0fdf4;"><i
                                            class="fas fa-hand-holding-usd text-success"></i></div>
                                    Payout Settings
                                    <span class="ql-badge">
                                        <%=totalHostedItems%> items
                                    </span>
                                </a>
                            </div>
                            <div class="col-md-6">
                                <a href="/trust/wallet" class="quick-link">
                                    <div class="ql-icon" style="background:#fef3c7;"><i
                                            class="fas fa-wallet text-warning"></i></div>
                                    My Wallet
                                    <span class="ql-badge">‚Çπ<%= (user.walletBalance||0).toLocaleString('en-IN') %>
                                            </span>
                                </a>
                            </div>
                            <div class="col-md-6">
                                <a href="/profile/reviews" class="quick-link">
                                    <div class="ql-icon" style="background:#fdf4ff;"><i class="fas fa-star text-purple"
                                            style="color:#9333ea;"></i></div>
                                    My Reviews
                                    <span class="ql-badge">
                                        <%= reviewCount %>
                                    </span>
                                </a>
                            </div>
                            <div class="col-md-6">
                                <a href="/notifications" class="quick-link">
                                    <div class="ql-icon" style="background:#f0fdf4;"><i
                                            class="fas fa-bell text-success"></i></div>
                                    Notifications
                                </a>
                            </div>
                            <div class="col-md-6">
                                <a href="/trust/verify" class="quick-link">
                                    <div class="ql-icon" style="background:#eef2ff;"><i
                                            class="fas fa-shield-alt text-indigo" style="color:#6366f1;"></i></div>
                                    ID Verification
                                    <span class="ql-badge">
                                        <%= user.verificationStatus || 'None' %>
                                    </span>
                                </a>
                            </div>
                            <div class="col-md-6">
                                <a href="/profile/edit" class="quick-link">
                                    <div class="ql-icon" style="background:#f8fafc;"><i
                                            class="fas fa-user-edit text-secondary"></i></div>
                                    Edit Profile
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- My Hosted Listings -->
                    <% if(totalHostedItems> 0) { %>
                        <div class="white-card">
                            <div class="card-title d-flex align-items-center justify-content-between">
                                <span><i class="fas fa-home"></i> My Hosted Listings</span>
                                <a href="/listings/new" class="btn-primary-custom"
                                    style="padding:6px 14px; font-size:0.78rem;"><i class="fas fa-plus"></i> Add New</a>
                            </div>
                            <div class="mini-items">
                                <% myListings.forEach(l=> { let img = l.image && l.image[0] ? l.image[0].url : null; %>
                                    <a href="/listings/<%= l._id %>" class="mini-item">
                                        <% if(img) { %><img src="<%= img %>" alt="<%= l.title %>">
                                            <% } else { %>
                                                <div class="mini-item-no-img"><i class="fas fa-home"></i></div>
                                                <% } %>
                                                    <div>
                                                        <div class="mini-item-title">
                                                            <%= l.title %>
                                                        </div>
                                                        <div class="mini-item-sub"><i
                                                                class="fas fa-map-marker-alt me-1"></i>
                                                            <%= l.location %> &nbsp;¬∑&nbsp; ‚Çπ<%=
                                                                    l.price.toLocaleString('en-IN') %>/night
                                                        </div>
                                                    </div>
                                                    <i class="fas fa-chevron-right ms-auto text-muted"
                                                        style="font-size:0.7rem;"></i>
                                    </a>
                                    <% }) %>
                                        <% myVehicles.forEach(v=> { let img = v.image ? v.image.url : null; %>
                                            <a href="/vehicles/<%= v._id %>" class="mini-item">
                                                <% if(img) { %><img src="<%= img %>" alt="<%= v.brand %>">
                                                    <% } else { %>
                                                        <div class="mini-item-no-img"><i class="fas fa-car"></i></div>
                                                        <% } %>
                                                            <div>
                                                                <div class="mini-item-title">
                                                                    <%= v.brand %>
                                                                        <%= v.model %>
                                                                </div>
                                                                <div class="mini-item-sub"><i
                                                                        class="fas fa-car me-1"></i>Vehicle
                                                                    &nbsp;¬∑&nbsp; ‚Çπ<%= v.price.toLocaleString('en-IN')
                                                                        %>/day</div>
                                                            </div>
                                                            <i class="fas fa-chevron-right ms-auto text-muted"
                                                                style="font-size:0.7rem;"></i>
                                            </a>
                                            <% }) %>
                                                <% myDhabas.forEach(d=> { let img = d.image && d.image[0] ?
                                                    d.image[0].url : null; %>
                                                    <a href="/dhabas/<%= d._id %>" class="mini-item">
                                                        <% if(img) { %><img src="<%= img %>" alt="<%= d.title %>">
                                                            <% } else { %>
                                                                <div class="mini-item-no-img"><i
                                                                        class="fas fa-utensils"></i></div>
                                                                <% } %>
                                                                    <div>
                                                                        <div class="mini-item-title">
                                                                            <%= d.title %>
                                                                        </div>
                                                                        <div class="mini-item-sub"><i
                                                                                class="fas fa-map-marker-alt me-1"></i>
                                                                            <%= d.location %> &nbsp;¬∑&nbsp; ‚Çπ<%=
                                                                                    d.price.toLocaleString('en-IN') %>
                                                                                    /person
                                                                        </div>
                                                                    </div>
                                                                    <i class="fas fa-chevron-right ms-auto text-muted"
                                                                        style="font-size:0.7rem;"></i>
                                                    </a>
                                                    <% }) %>
                            </div>
                        </div>
                        <% } %>

                            <!-- Recent Bookings -->
                            <% if(recentBookings.length> 0) { %>
                                <div class="white-card">
                                    <div class="card-title d-flex align-items-center justify-content-between">
                                        <span><i class="fas fa-calendar-alt"></i> Recent Bookings</span>
                                        <a href="/bookings"
                                            style="font-size:0.8rem; color:#6366f1; font-weight:600; text-decoration:none;">View
                                            All</a>
                                    </div>
                                    <% recentBookings.forEach(b=> {
                                        let title = b.listing ? b.listing.title : (b.vehicle ? (b.vehicle.brand + ' ' +
                                        b.vehicle.model) : (b.dhaba ? b.dhaba.title : 'Booking'));
                                        let icon = b.type === 'listing' ? 'fa-home' : b.type === 'vehicle' ? 'fa-car' :
                                        'fa-utensils';
                                        let iconBg = b.type === 'listing' ? '#eff6ff' : b.type === 'vehicle' ? '#fdf4ff'
                                        : '#fff7ed';
                                        let iconColor = b.type === 'listing' ? '#3b82f6' : b.type === 'vehicle' ?
                                        '#9333ea' : '#f59e0b';
                                        let stBg = b.status === 'Confirmed' ? '#f0fdf4' : b.status === 'Cancelled' ?
                                        '#fef2f2' : '#fefce8';
                                        let stColor = b.status === 'Confirmed' ? '#16a34a' : b.status === 'Cancelled' ?
                                        '#dc2626' : '#ca8a04';
                                        %>
                                        <div class="booking-row">
                                            <div class="booking-icon"
                                                style="background:<%= iconBg %>; color:<%= iconColor %>;"><i
                                                    class="fas <%= icon %>"></i></div>
                                            <div>
                                                <div class="fw-bold" style="font-size:0.88rem;">
                                                    <%= title %>
                                                </div>
                                                <div class="text-muted" style="font-size:0.75rem;">
                                                    <%= new Date(b.createdAt).toLocaleDateString('en-IN',
                                                        {day:'numeric', month:'short', year:'numeric'}) %>
                                                </div>
                                            </div>
                                            <div class="text-end ms-auto">
                                                <div class="fw-bold" style="font-size:0.88rem;">‚Çπ<%=
                                                        (b.totalPrice||0).toLocaleString('en-IN') %>
                                                </div>
                                                <span class="booking-status"
                                                    style="background:<%= stBg %>; color:<%= stColor %>;">
                                                    <%= b.status %>
                                                </span>
                                            </div>
                                        </div>
                                        <% }) %>
                                </div>
                                <% } %>

                                    <!-- Sign Out -->
                                    <a href="/logout"
                                        class="btn btn-outline-danger w-100 rounded-pill py-3 fw-bold mt-2">
                                        <i class="fas fa-sign-out-alt me-2"></i> Sign Out of WanderLust
                                    </a>

                </div><!-- end right col -->
            </div><!-- end row -->
        </div><!-- end container -->
    </div>